<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":10000,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Linux中系统监控的工具，进程、IO、网络等。">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux系统监控">
<meta property="og:url" content="http://example.com/2023/06/22/Linux%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7/index.html">
<meta property="og:site_name" content="HZ&#39;Blog">
<meta property="og:description" content="Linux中系统监控的工具，进程、IO、网络等。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-06-22T05:36:33.000Z">
<meta property="article:modified_time" content="2023-06-24T16:23:37.795Z">
<meta property="article:author" content="Honghangzhi">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2023/06/22/Linux%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Linux系统监控 | HZ'Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">HZ'Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/06/22/Linux%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Honghangzhi">
      <meta itemprop="description" content="不积跬步，无以千里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HZ'Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linux系统监控
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-22 13:36:33" itemprop="dateCreated datePublished" datetime="2023-06-22T13:36:33+08:00">2023-06-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-25 00:23:37" itemprop="dateModified" datetime="2023-06-25T00:23:37+08:00">2023-06-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                  <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                    <a href="/categories/%E5%B7%A5%E5%85%B7/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                  </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2023/06/22/Linux%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2023/06/22/Linux%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Linux中系统监控的工具，进程、IO、网络等。</p>
<span id="more"></span>

<h2 id="进程相关"><a href="#进程相关" class="headerlink" title="进程相关"></a>进程相关</h2><h3 id="查看进程"><a href="#查看进程" class="headerlink" title="查看进程"></a>查看进程</h3><ul>
<li><p>ps：显示当前所有<strong>进程</strong>的运行情况。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ ps</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">13316 pts/0    00:00:00 bash</span><br><span class="line">16999 pts/0    00:00:00 ps</span><br></pre></td></tr></table></figure></li>
<li><p>top：<strong>实时显示</strong>当前所有<strong>任务</strong>的资源占用情况。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                </span><br><span class="line"> 1173 root      10 -10  166140  49928  10452 S   1.7  2.8   2:24.79 AliYunDunMonito                                                                        </span><br><span class="line">13233 hz        20   0  709408  46020  15864 S   1.0  2.6   0:06.84 node                                                                                   </span><br><span class="line"> 1109 root      20   0  815440  14616   7292 S   0.3  0.8   0:08.32 aliyun-service                                                                         </span><br><span class="line">    1 root      20   0   43628   4000   2600 S   0.0  0.2   0:00.77 systemd                                                                                </span><br><span class="line">    2 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kthreadd                                                                               </span><br><span class="line">    4 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/0:0H                                                                           </span><br><span class="line">    6 root      20   0       0      0      0 S   0.0  0.0   0:00.12 ksoftirqd/0             </span><br></pre></td></tr></table></figure></li>
<li><p>pstree 以树状的模式输出进程列表，该模式显示了进程间的父/子关系</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ pstree</span><br><span class="line">systemd─┬─AliYunDun───9*[&#123;AliYunDun&#125;]</span><br><span class="line">        ├─AliYunDunMonito───25*[&#123;AliYunDunMonito&#125;]</span><br><span class="line">        ├─AliYunDunUpdate───6*[&#123;AliYunDunUpdate&#125;]</span><br><span class="line">        ├─2*[agetty]</span><br><span class="line">        ├─aliyun-service───7*[&#123;aliyun-service&#125;]</span><br><span class="line">        ├─assist_daemon───7*[&#123;assist_daemon&#125;]</span><br><span class="line">        ├─atd</span><br><span class="line">        ├─auditd───&#123;auditd&#125;</span><br><span class="line">        ├─chronyd</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─dbus-daemon</span><br><span class="line">        ├─dhclient</span><br><span class="line">        ├─epmd</span><br><span class="line">        ├─gssproxy───5*[&#123;gssproxy&#125;]</span><br><span class="line">        ├─master─┬─pickup</span><br><span class="line">        │        └─qmgr</span><br><span class="line">        ├─polkitd───6*[&#123;polkitd&#125;]</span><br><span class="line">        ├─rpcbind</span><br><span class="line">        ├─rsyslogd───2*[&#123;rsyslogd&#125;]</span><br><span class="line">        ├─sshd───sshd───sshd───bash─┬─sh───node─┬─node─┬─bash─┬─pstree</span><br><span class="line">        │                           │           │      │      └─python3</span><br><span class="line">        │                           │           │      ├─bash</span><br><span class="line">        │                           │           │      └─12*[&#123;node&#125;]</span><br><span class="line">        │                           │           ├─node─┬─node───6*[&#123;node&#125;]</span><br><span class="line">        │                           │           │      └─11*[&#123;node&#125;]</span><br><span class="line">        │                           │           ├─node───12*[&#123;node&#125;]</span><br><span class="line">        │                           │           └─10*[&#123;node&#125;]</span><br><span class="line">        │                           └─sleep</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        └─tuned───4*[&#123;tuned&#125;]</span><br></pre></td></tr></table></figure></li>
<li><p>vmstat<br>虚拟内存统计，报告有关进程、内存、分页、块 IO、中断和 CPU 活动等信息。<br>如果想要持续查看输出，可以在命令后面加上一个间隔时间（以秒为单位），命令将按照间隔时间来动态更新显示的内容（比如，vmstat 5）。按下Ctrl-C键可以终止输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ vmstat 5</span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</span><br><span class="line"> 1  0      0 158636  49584 1228320    0    0    38    52  936 1747  2  1 98  0  0</span><br></pre></td></tr></table></figure></li>
<li><p>jobs：列出所有活动作业的状态信息。</p>
</li>
</ul>
<h3 id="控制进程"><a href="#控制进程" class="headerlink" title="控制进程"></a>控制进程</h3><h4 id="暂停和中断进程"><a href="#暂停和中断进程" class="headerlink" title="暂停和中断进程"></a>暂停和中断进程</h4><p>按下<strong>Ctrl-Z</strong>键，程序将会暂停，此时可以用fg和bg让其继续工作。</p>
<p>在终端里按下<strong>Ctrl-C</strong>键将会中断（interrupt）一个程序，它意味着我们委婉地<strong>请求程序结束</strong>。许多（但不是所有）命令行程序都可以使用这种方法来实现中断。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ jobs</span><br><span class="line">[hz@aliyun erlang-project]$ python3</span><br><span class="line">Python 3.6.8 (default, Nov 16 2020, 16:55:22) </span><br><span class="line">[GCC 4.8.5 20150623 (Red Hat 4.8.5-44)] on linux</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">[1]+  Stopped                 python3</span><br><span class="line">[hz@aliyun erlang-project]$ jobs</span><br><span class="line">[1]+  Stopped                 python3</span><br></pre></td></tr></table></figure>

<h4 id="使进程后台运行"><a href="#使进程后台运行" class="headerlink" title="使进程后台运行"></a>使进程后台运行</h4><p>在命令后面加上和号字符（&amp;）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gedit &amp;</span><br></pre></td></tr></table></figure>

<h4 id="使进程回到前台运行"><a href="#使进程回到前台运行" class="headerlink" title="使进程回到前台运行"></a>使进程回到前台运行</h4><p>使用fg设置在前台中运行作业，要用到作业编号（jobspec选项），一般先用jobs命令查看挂起的进程的作业号，再用fg命令使其运行</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">fg</span> %1</span><br></pre></td></tr></table></figure>

<h4 id="在后台运行"><a href="#在后台运行" class="headerlink" title="在后台运行"></a>在后台运行</h4><p>此时可以用fg命令设置在前台中运行作业，也可以用bg命令设置在后台中运行作业。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bg</span> %1</span><br></pre></td></tr></table></figure>

<h2 id="IO相关"><a href="#IO相关" class="headerlink" title="IO相关"></a>IO相关</h2><ul>
<li><p>iostat CPU 的使用情况，以及设备、分区和网络文件系统（NFS）的 IO 统计信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ iostat </span><br><span class="line">Linux 3.10.0-1160.90.1.el7.x86_64 (aliyun.ecs)  06/24/2023      _x86_64_        (2 CPU)</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           1.58    0.00    0.60    0.06    0.00   97.76</span><br><span class="line"></span><br><span class="line">Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">vda               5.12        68.74        95.46     593791     824644</span><br></pre></td></tr></table></figure></li>
<li><p>iotop 命令利用 Linux 内核监控 I/O 使用情况，它按进程或线程的顺序显示 I/O 使用情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> sudo iotop</span><br><span class="line"> </span><br><span class="line"> TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;    COMMAND                                                                                     </span><br><span class="line">13312 be/4 hz          0.00 B/s    0.00 B/s  0.00 %  0.00 % node /home/hz/.vscode-server/bin/97dec172d3256f~onServerMain --node-ipc --clientProcessId=13267</span><br><span class="line">    1 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % systemd --switched-root --system --deserialize 22</span><br><span class="line">    2 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [kthreadd]</span><br><span class="line">13315 be/4 hz          0.00 B/s    0.00 B/s  0.00 %  0.00 % node /home/hz/.vscode-server/bin/97dec172d3256f~onServerMain --node-ipc --clientProcessId=13267</span><br><span class="line">    4 be/0 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [kworker/0:0H]</span><br><span class="line"> 1029 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % python2 -Es /usr/sbin/tuned -l -P</span><br><span class="line">    6 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.00 % [ksoftirqd/0]</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="网络相关"><a href="#网络相关" class="headerlink" title="网络相关"></a>网络相关</h2><ul>
<li><p>ping：向网络主机发送ICMP ECHO_REQUEST数据包。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ ping youkia.com</span><br><span class="line">PING youkia.com (117.78.38.96) 56(84) bytes of data.</span><br><span class="line">64 bytes from ecs-117-78-38-96.compute.hwclouds-dns.com (117.78.38.96): icmp_seq=1 ttl=46 time=55.3 ms</span><br><span class="line">64 bytes from ecs-117-78-38-96.compute.hwclouds-dns.com (117.78.38.96): icmp_seq=2 ttl=46 time=55.3 ms</span><br><span class="line">64 bytes from ecs-117-78-38-96.compute.hwclouds-dns.com (117.78.38.96): icmp_seq=3 ttl=46 time=55.3 ms</span><br><span class="line">...</span><br></pre></td></tr></table></figure></li>
<li><p>traceroute：显示数据包到网络主机的路由路径。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ traceroute youkia.com</span><br><span class="line">traceroute to youkia.com (117.78.38.96), 30 hops max, 60 byte packets</span><br><span class="line"> 1  11.63.116.46 (11.63.116.46)  1.122 ms  1.124 ms  1.137 ms</span><br><span class="line"> 2  11.63.116.113 (11.63.116.113)  1.233 ms 10.124.228.125 (10.124.228.125)  1.290 ms 10.124.228.81 (10.124.228.81)  1.281 ms</span><br><span class="line"> 3  11.88.168.49 (11.88.168.49)  1.557 ms 11.48.239.121 (11.48.239.121)  1.137 ms 11.48.239.197 (11.48.239.197)  0.825 ms</span><br><span class="line"> 4  45.112.220.65 (45.112.220.65)  1.807 ms 45.112.220.89 (45.112.220.89)  1.356 ms 45.112.220.13 (45.112.220.13)  1.865 ms</span><br><span class="line"> 5  117.49.54.102 (117.49.54.102)  9.292 ms  9.277 ms 117.49.54.50 (117.49.54.50)  5.757 ms</span><br><span class="line"> 6  11.94.166.53 (11.94.166.53)  45.763 ms * 11.94.136.185 (11.94.136.185)  60.216 ms</span><br><span class="line"> 7  45.112.223.250 (45.112.223.250)  50.328 ms 10.102.154.246 (10.102.154.246)  41.797 ms 45.112.216.34 (45.112.216.34)  44.119 ms</span><br><span class="line"> 8  103.216.40.49 (103.216.40.49)  43.525 ms  43.945 ms  43.536 ms</span><br></pre></td></tr></table></figure></li>
<li><p>netstat：显示网络连接、路由表、网络接口数据、伪连接以及多点传送成员等信息。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ netstat -ie</span><br><span class="line">Kernel Interface table</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.173.142  netmask 255.255.240.0  broadcast 172.17.175.255</span><br><span class="line">        inet6 fe80::216:3eff:fe0d:5a2f  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:16:3e:0d:5a:2f  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 24134  bytes 7211877 (6.8 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 24984  bytes 14476371 (13.8 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 28338  bytes 5183587 (4.9 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 28338  bytes 5183587 (4.9 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li><p>ss 获取套接字统计信息，可以显示类似于 netstat 的信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 显示所有 TCP 或 UDP 套接字</span><br><span class="line">[hz@aliyun erlang-project]$ ss -t -a</span><br><span class="line">State       Recv-Q Send-Q                              Local Address:Port                                               Peer Address:Port                </span><br><span class="line">LISTEN      0      128                                             *:sunrpc                                                        *:*                    </span><br><span class="line">LISTEN      0      128                                             *:epmd                                                          *:*                   </span><br></pre></td></tr></table></figure></li>
<li><p>tcpdump</p>
<ul>
<li><p><strong>-i</strong> : 选择要捕获的接口，通常是以太网卡或无线网卡，也可以是 <code>vlan</code> 或其他特殊接口。如果该系统上只有一个网络接口，则无需指定。<br>注意：当是本机内部通信时, 走的是lo，此时是抓不到包的，必须指定网卡。</p>
</li>
<li><p><strong>-nn</strong> : 单个 n 表示不解析域名，直接显示 IP；两个 n 表示不解析域名和端口。这样不仅方便查看 IP 和端口号，而且在抓取大量数据时非常高效，因为域名解析会降低抓取速度。</p>
</li>
<li><p><strong>-s0</strong> : tcpdump 默认只会截取前 <code>96</code> 字节的内容，要想截取所有的报文内容，可以使用 <code>-s number</code>， <code>number</code> 就是你要截取的报文字节数，如果是 0 的话，表示截取报文全部内容。</p>
</li>
<li><p><strong>-v</strong> : 使用 <code>-v</code>，<code>-vv</code> 和 <code>-vvv</code> 来显示更多的详细信息，通常会显示更多与特定协议相关的信息。</p>
</li>
<li><p><code>port 80</code> : 这是一个常见的端口过滤器，表示仅抓取 <code>80</code> 端口上的流量，通常是 HTTP。</p>
</li>
<li><p>-A 以 ASCII 格式打印每个数据包</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0 -nn -s0 -v port 80</span><br><span class="line">tcpdump -A -s0 port 80 <span class="comment"># 以ASCII字符串 打印数据包</span></span><br><span class="line">tcpdump -i eth0 udp <span class="comment"># 指定协议</span></span><br><span class="line">tcpdump -i eth0 proto 17 <span class="comment"># 同上一条命令</span></span><br><span class="line">tcpdump -i eth0 -s0 -w test.pcap <span class="comment"># 写入文件</span></span><br><span class="line">tcpdump -i eth0 -s0 -l port 80 | grep <span class="string">&#x27;Server:&#x27;</span> <span class="comment"># 要实时将抓取到的数据通过管道传递给其他工具来处理 需要使用行缓冲模式</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>过滤器</p>
<ul>
<li><p>过滤host</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tcpdump host 1.2.3.4 # 指定主机 </span><br><span class="line">tcpdump -i eth0 dst 10.10.1.20 # src和dst是可选项=</span><br></pre></td></tr></table></figure></li>
<li><p>过滤网段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tcpdump net 192.168.1 # 三元组 192.168.1.x 发出或发往</span><br><span class="line">tcpdump src net 10 # 一元组 表示子网掩码255.0.0.0</span><br><span class="line"># 二元组 255.255.0.0</span><br><span class="line"># 四元组 某主机</span><br><span class="line">tcpdump src net 172.16.0.0/12 # CIDR</span><br></pre></td></tr></table></figure></li>
<li><p>过滤协议</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -n proto \\icmp	# 保留字用双斜杠</span><br></pre></td></tr></table></figure></li>
<li><p>过滤端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump port 389</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="综合工具"><a href="#综合工具" class="headerlink" title="综合工具"></a>综合工具</h2><ul>
<li><p>dstat 显示 CPU 使用率、内存使用率、磁盘 I/O、网络流量等系统资源的情况</p>
<ul>
<li>-l ：显示负载统计量</li>
<li>-m ：显示内存使用率（包括used，buffer，cache，free值）</li>
<li>-r ：显示I/O统计</li>
<li>-s ：显示交换分区使用情况</li>
<li>-t ：将当前时间显示在第一行</li>
<li>–fs ：显示文件系统统计数据（包括文件总数量和inodes值）</li>
<li>–nocolor ：不显示颜色（有时候有用）</li>
<li>–socket ：显示网络统计数据</li>
<li>–tcp ：显示常用的TCP统计</li>
<li>–udp ：显示监听的UDP接口及其当前用量的一些动态数据</li>
<li>附带插件<ul>
<li>-–disk-util ：显示某一时间磁盘的忙碌状况</li>
<li>-–freespace ：显示当前磁盘空间使用率</li>
<li>-–proc-count ：显示正在运行的程序数量</li>
<li>-–top-bio ：指出块I/O最大的进程</li>
<li>-–top-cpu ：图形化显示CPU占用最大的进程</li>
<li>-–top-io ：显示正常I/O最大的进程</li>
<li>-–top-mem ：显示占用最多内存的进程</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[hz@aliyun erlang-project]$ dstat</span><br><span class="line">You did not select any stats, using -cdngy by default.</span><br><span class="line">----total-cpu-usage---- -dsk/total- -net/total- ---paging-- ---system--</span><br><span class="line">usr sys idl wai hiq siq| read  writ| recv  send|  in   out | int   csw </span><br><span class="line">  2   1  98   0   0   0|  71k   98k|   0     0 |   0     0 |1851  3457 </span><br><span class="line">  1   1  98   0   0   0|   0     0 | 840B 3842B|   0     0 |2021  3567 </span><br><span class="line">  1   1  98   0   0   0|   0     0 | 120B  260B|   0     0 |1854  3420 </span><br><span class="line">  2   1  97   0   0   0|   0     0 | 460B  500B|   0     0 |1955  3532 </span><br><span class="line">  1   1  99   0   0   0|   0     0 | 120B  122B|   0     0 |1798  3296 </span><br><span class="line"> </span><br><span class="line"># 监控swap，process，sockets，filesystem并显示监控的时间</span><br><span class="line">[hz@aliyun erlang-project]$ dstat -tsp --socket --fs</span><br><span class="line">----system---- ----swap--- ---procs--- ------sockets------ --filesystem-</span><br><span class="line">     time     | used  free|run blk new|tot tcp udp raw frg|files  inodes</span><br><span class="line">24-06 23:39:21|   0     0 |0.0   0 5.5|223  11   4   0   0| 1280  49802 </span><br><span class="line">24-06 23:39:22|   0     0 |  0   0 8.0|229  11   4   0   0| 1344  49823 </span><br><span class="line">24-06 23:39:23|   0     0 |  0   0 7.0|223  11   4   0   0| 1344  49804 </span><br><span class="line">24-06 23:39:24|   0     0 |  0   0   0|223  11   4   0   0| 1344  49804 ^C</span><br></pre></td></tr></table></figure></li>
</ul>

    </div>

    
    
    

    
      <div>
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:24px;">（完）</div>
    
</div>
      </div>
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/04/12/gen_server/" rel="prev" title="gen_server">
      <i class="fa fa-chevron-left"></i> gen_server
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/06/22/erlang%E4%B8%AD%E7%9A%84%E5%AE%B9%E5%99%A8/" rel="next" title="erlang中的容器">
      erlang中的容器 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E7%9B%B8%E5%85%B3"><span class="nav-number">1.</span> <span class="nav-text">进程相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B"><span class="nav-number">1.1.</span> <span class="nav-text">查看进程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E8%BF%9B%E7%A8%8B"><span class="nav-number">1.2.</span> <span class="nav-text">控制进程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9A%82%E5%81%9C%E5%92%8C%E4%B8%AD%E6%96%AD%E8%BF%9B%E7%A8%8B"><span class="nav-number">1.2.1.</span> <span class="nav-text">暂停和中断进程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E8%BF%9B%E7%A8%8B%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C"><span class="nav-number">1.2.2.</span> <span class="nav-text">使进程后台运行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E8%BF%9B%E7%A8%8B%E5%9B%9E%E5%88%B0%E5%89%8D%E5%8F%B0%E8%BF%90%E8%A1%8C"><span class="nav-number">1.2.3.</span> <span class="nav-text">使进程回到前台运行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%A8%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C"><span class="nav-number">1.2.4.</span> <span class="nav-text">在后台运行</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IO%E7%9B%B8%E5%85%B3"><span class="nav-number">2.</span> <span class="nav-text">IO相关</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3"><span class="nav-number">3.</span> <span class="nav-text">网络相关</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%BC%E5%90%88%E5%B7%A5%E5%85%B7"><span class="nav-number">4.</span> <span class="nav-text">综合工具</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Honghangzhi"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Honghangzhi</p>
  <div class="site-description" itemprop="description">不积跬步，无以千里</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Honghangzhi</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'Wk2wsEFrasa9yOsstHf3YRlp-gzGzoHsz',
      appKey     : 'zKA4ww3CAjsjGZ52EFJPkpRn',
      placeholder: "欢迎交流讨论...",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
